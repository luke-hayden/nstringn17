codeset$shortname <- substr(codeset$Customer_Identifier, 1,2)
Cht <- read.table("CodeSetCountdata.txt")
ctg5and6.norm <- NanoStringNorm(x = ct5and6.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg5and6hi.norm <- NanoStringNorm(x = ct5and6hi.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg7and8.norm <- NanoStringNorm(x = ct7and8.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
#ctg7and8hi.norm <- NanoStringNorm(x = ct7and8hi.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg3and4.norm <- NanoStringNorm(x = ct3and4.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg5and6.norm <- NanoStringNorm(x = ct5and6.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg5and6.norm <- NanoStringNorm(x = ct5and6.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
colnames(ctg5and6hi.norm) <-  c("SFPA", "SFPB", "LFPA", "LFPB", "SMPA", "SMPB", "LMPA", "LMPB", "LMIA", "LMIB", "LMIC", "LMID", "Abef", "Aun", "Areg", "Bbef", "Bun", "Breg", "Cbef", "Cun", "Creg", "Dbef", "Dun", "Dreg")
colnames(ctg7and8.norm) <- c("SFPC","SFPD", "LFPC", "LFPD", "SMPC", "SMPD","LMPC", "LMPD", "0mPA", "0mPB", "10mPA", "20mPA", "Ebef", "Eun", "Ereg", "Fbef", "Fun", "Freg", "Gbef", "Gun", "Greg", "LFIA", "LFIB", "20mPB")
colnames(ctg7and8.norm) <- c("SFPC","SFPD", "LFPC", "LFPD", "SMPC", "SMPD","LMPC", "LMPD", "0mPA", "0mPB", "10mPA", "20mPA", "Ebef", "Eun", "Ereg", "Fbef", "Fun", "Freg", "Gbef", "Gun", "Greg", "LFIA", "LFIB", "20mPB")
ctg7and8.norm <- NanoStringNorm(x = ct7and8.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg3and4.norm <- NanoStringNorm(x = ct3and4.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
load("~/.RData")
#all <- ctg3to8
#all$isg <- rownames(ctg3to8) %in% gm
mc36 <- melt(ctg3to8)
ctg3to8 <- cbind(ctg3and4.norm, ctg5and6hi.norm, ctg7and8.norm)
sampleinfo <- data.frame(sample=colnames(ctg3to8), sex=c(rep("F", 28), rep("M", 8), rep("F", 16), rep("M", 8), rep("F", 12)), age=c(rep(c("O", "O", "Y", "Y", "O", "O", "Y", "Y","Y", "Y", "O", "O"), 2), rep(c("Y", "Y", "O", "O", "Y", "Y", "O", "O", "O", "O", "O", "O", rep("O", 12)), 2)), reg=c(rep(c(rep("", 4), rep("R", 4), rep("", 4)), 2), c(rep("", 12), rep(c("", "", "R"),4 )   ), c(rep("", 12), rep(c("", "", "R"),3 )   ), "", "", "") , ctg=c(rep("3", 12), rep("4", 12), rep("5", 12), rep("6", 12), rep("7", 12), rep("8", 12))  )
sampleinfo$type <- paste(sampleinfo$age, sampleinfo$reg, sep="")
sampleinfo$qual <- "ok"
sampleinfo$qual[c(1,7,8, 25, 43, 52)] <- "bad"
View(ctg3to8)
colnames(ctg5and6.norm) <- c("SFPA", "SFPB", "LFPA", "LFPB", "SMPA", "SMPB", "LMPA", "LMPB", "LMIA", "LMIB", "LMIC", "LMID", "Abef", "Aun", "Areg", "Bbef", "Bun", "Breg", "Cbef", "Cun", "Creg", "Dbef", "Dun", "Dreg")
colnames(ctg5and6hi.norm) <-  c("SFPA", "SFPB", "LFPA", "LFPB", "SMPA", "SMPB", "LMPA", "LMPB", "LMIA", "LMIB", "LMIC", "LMID", "Abef", "Aun", "Areg", "Bbef", "Bun", "Breg", "Cbef", "Cun", "Creg", "Dbef", "Dun", "Dreg")
colnames(ctg7and8.norm) <- c("SFPC","SFPD", "LFPC", "LFPD", "SMPC", "SMPD","LMPC", "LMPD", "0mPA", "0mPB", "10mPA", "20mPA", "Ebef", "Eun", "Ereg", "Fbef", "Fun", "Freg", "Gbef", "Gun", "Greg", "LFIA", "LFIB", "20mPB")
colnames(ctg7and8hi.norm) <-c("SFPC","SFPD", "LFPC", "LFPD", "SMPC", "SMPD","LMPC", "LMPD", "0mPA", "0mPB", "10mPA", "20mPA", "Ebef", "Eun", "Ereg", "Fbef", "Fun", "Freg", "Gbef", "Gun", "Greg", "LFIA", "LFIB", "20mPB")
colnames(ctg5and6.norm) <- c("SFPA", "SFPB", "LFPA", "LFPB", "SMPA", "SMPB", "LMPA", "LMPB", "LMIA", "LMIB", "LMIC", "LMID", "Abef", "Aun", "Areg", "Bbef", "Bun", "Breg", "Cbef", "Cun", "Creg", "Dbef", "Dun", "Dreg")
colnames(ctg5and6hi.norm) <-  c("SFPA", "SFPB", "LFPA", "LFPB", "SMPA", "SMPB", "LMPA", "LMPB", "LMIA", "LMIB", "LMIC", "LMID", "Abef", "Aun", "Areg", "Bbef", "Bun", "Breg", "Cbef", "Cun", "Creg", "Dbef", "Dun", "Dreg")
colnames(ctg7and8.norm) <- c("SFPC","SFPD", "LFPC", "LFPD", "SMPC", "SMPD","LMPC", "LMPD", "0mPA", "0mPB", "10mPA", "20mPA", "Ebef", "Eun", "Ereg", "Fbef", "Fun", "Freg", "Gbef", "Gun", "Greg", "LFIA", "LFIB", "20mPB")
#colnames(ctg7and8hi.norm) <-c("SFPC","SFPD", "LFPC", "LFPD", "SMPC", "SMPD","LMPC", "LMPD", "0mPA", "0mPB", "10mPA", "20mPA", "Ebef", "Eun", "Ereg", "Fbef", "Fun", "Freg", "Gbef", "Gun", "Greg", "LFIA", "LFIB", "20mPB")
colnames(ctg3and4.norm) <- c("O1a", "O2a", "Y1a", "Y2a", "OR1a", "OR2a", "YR1a", "YR2a", "FY5a", "FY6a", "FO5a", "FO7a", "O1b", "O2b", "Y1b", "Y2b", "OR1b", "OR2b", "YR1b", "YR2b", "FY7", "FY8", "FO8", "FO9")
ctg3to8 <- cbind(ctg3and4.norm, ctg5and6hi.norm, ctg7and8.norm)
sampleinfo <- data.frame(sample=colnames(ctg3to8), sex=c(rep("F", 28), rep("M", 8), rep("F", 16), rep("M", 8), rep("F", 12)), age=c(rep(c("O", "O", "Y", "Y", "O", "O", "Y", "Y","Y", "Y", "O", "O"), 2), rep(c("Y", "Y", "O", "O", "Y", "Y", "O", "O", "O", "O", "O", "O", rep("O", 12)), 2)), reg=c(rep(c(rep("", 4), rep("R", 4), rep("", 4)), 2), c(rep("", 12), rep(c("", "", "R"),4 )   ), c(rep("", 12), rep(c("", "", "R"),3 )   ), "", "", "") , ctg=c(rep("3", 12), rep("4", 12), rep("5", 12), rep("6", 12), rep("7", 12), rep("8", 12))  )
sampleinfo$type <- paste(sampleinfo$age, sampleinfo$reg, sep="")
sampleinfo$qual <- "ok"
sampleinfo$qual[c(1,7,8, 25, 43, 52)] <- "bad"
#all <- ctg3to8
#all$isg <- rownames(ctg3to8) %in% gm
mc36 <- melt(ctg3to8)
mc36$exp <- mc36$value > 1
mc36$isg <- mc36$Var1 %in% gm$marker
ggplot(mc36, aes(y=value, x=Var1, colour=isg)) +geom_point(alpha=0.3) +facet_wrap(~Var2) +scale_y_log10() +scale_colour_manual
#all <- ctg3to8
#all$isg <- rownames(ctg3to8) %in% gm
mc36 <- melt(ctg3to8)
mc36$exp <- mc36$value > 1
mc36$isg <- mc36$Var1 %in% gm$marker
ggplot(mc36, aes(y=value, x=Var1, colour=isg)) +geom_point(alpha=0.3) +facet_wrap(~Var2) +scale_y_log10()
#ggplot(mc36, aes(y=value, x=Var1, colour=exp)) +geom_point(alpha=0.3, shape=95, size=5) +facet_wrap(~Var2) +scale_y_log10() + theme(  axis.text.x = element_blank())
mc5 <- melt(ctg5and6.norm)
mc5h <- melt(ctg5and6hi.norm)
mc5h$hival <- mc5$value
ggplot(data=mc5h, aes(x=value, y=hival, colour=Var2)) +geom_point() +facet_wrap(~Var2, ncol=6) +scale_x_log10() +scale_y_log10()
bcmin <- ctg3to8[,c(2,3,4,9,10,11,12,13:16,21:24,26:28,49:52)]
bcmin <- subset(bcmin, rownames(bcmin) %in% gm$marker)
tbc <- t(bcmin)
tbc <- tbc[,colSums(tbc) > 0]
bc.pca <- prcomp(tbc,center = TRUE,scale. = TRUE)
bc.groups <- c( "O", "Y", "Y", "Y", "Y", "O", "O", "O", "O", "Y", "Y", "Y", "Y", "O", "O","Y","O","O","Y", "Y","O","O")
ggbiplot(bc.pca, obs.scale = 1, var.scale = 1, ellipse = FALSE, circle = TRUE, var.axes=FALSE, labels=rownames(tbc), groups=bc.groups)+ theme(legend.direction = 'horizontal', legend.position = 'none')+ggtitle("PCA of O vs Y: 61 chosen markers")+ scale_colour_manual(values=c("cornflower blue", "red3"))
log <- sampleinfo$sex =="F" & sampleinfo$ctg %in% c(3,4,5,7) & sampleinfo$qual == "ok" & sampleinfo$reg == ""
bcmin <- ctg3to8[,log== TRUE]
bcmin.groups <- subset(sampleinfo$type, log==TRUE)
bcmin <- subset(bcmin, rownames(bcmin) %in% gm$marker)
tbc <- t(bcmin)
tbc <- tbc[,colSums(tbc) > 0]
bc.pca <- prcomp(tbc,center = TRUE,scale. = TRUE)
bc.groups <- bcmin.groups
ggbiplot(bc.pca, obs.scale = 1, var.scale = 1, ellipse = FALSE, circle = TRUE, var.axes=FALSE, labels=rownames(tbc), groups=bc.groups)+ theme(legend.direction = 'horizontal', legend.position = 'none')+ggtitle("PCA of O vs Y: 61 chosen markers")+ scale_colour_manual(values=c("cornflower blue", "red3"))
rg <-ctg3to8[,c(5,6,17,18,37:42,44:48,61:69)]
rg <- subset(rg, rownames(rg) %in% gm$marker)
rg.groups <- sampleinfo$type[c(5,6,17,18,37:42,44:48,61:69)]
rg.sc <- scale(t(rg), center= bc.pca$center)
rg.pred <- rg.sc %*% bc.pca$rotation
rgd.pca <- bc.pca
rgd.pca$x <- rbind(bc.pca$x, rg.pred)
rgd.groups <- append(bcmin.groups, rg.groups)
ggbiplot(rgd.pca, obs.scale = 1, var.scale = 1, ellipse = FALSE, circle = TRUE, var.axes=FALSE, labels=rownames(rgd.pca$x), groups=rgd.groups, varname.abbrev = TRUE)+ theme(legend.direction = 'horizontal', legend.position = 'top')+ggtitle("PCA Old vs Young, using just our subset of 61 markers + new projected")+ scale_colour_manual(values=c("cornflower blue", "forest green", "red3"))
an <- ctg3to8/rowMeans(ctg3to8)
an <- subset(an, rownames(an) %in% gm$marker)
log <- sampleinfo$sex =="F" &  sampleinfo$qual == "ok" & sampleinfo$type != "YR"
anf <- an[,log==TRUE]
sif <- subset(sampleinfo, log)
colnames(anf) <- paste( sif$type, colnames(anf))
#anf <- rbind(anf, t(sif))
manf <- melt(anf)
manf$type <- substr(manf$Var2,1,2)
manf$mk <- substr(manf$Var1, 1,2)
manf$dir <- "upregulated with age"
manf$dir[manf$Var1 %in% gm$marker[gm$dir =="downregulated with age"]] <- "downregulated with age"
manf$dm <- paste(substr(manf$dir, ))
an <- ctg3to8/rowMeans(ctg3to8)
an <- subset(an, rownames(an) %in% gm$marker)
log <- sampleinfo$sex =="F" &  sampleinfo$qual == "ok" & sampleinfo$type != "YR"
anf <- an[,log==TRUE]
sif <- subset(sampleinfo, log)
colnames(anf) <- paste( sif$type, colnames(anf))
#anf <- rbind(anf, t(sif))
manf <- melt(anf)
manf$type <- substr(manf$Var2,1,2)
manf$mk <- substr(manf$Var1, 1,2)
manf$dir <- "upregulated with age"
manf$dir[manf$Var1 %in% gm$marker[gm$dir =="downregulated with age"]] <- "downregulated with age"
manf$dm <- paste(substr(manf$dir, 1,1), manf$mk
ggplot(manf, aes(x=mk, y=value, colour=type)) +geom_point(shape=95, size=4)  +scale_color_manual(values=c("cornflower blue", "red3", "forest green"), name= "Age", labels=c("Old", "Young", "Regenerated Old")) +scale_y_log10()
manf$dm <- paste(substr(manf$dir, 1,1), manf$mk)
an <- ctg3to8/rowMeans(ctg3to8)
an <- subset(an, rownames(an) %in% gm$marker)
log <- sampleinfo$sex =="F" &  sampleinfo$qual == "ok" & sampleinfo$type != "YR"
anf <- an[,log==TRUE]
sif <- subset(sampleinfo, log)
colnames(anf) <- paste( sif$type, colnames(anf))
#anf <- rbind(anf, t(sif))
manf <- melt(anf)
manf$type <- substr(manf$Var2,1,2)
manf$mk <- substr(manf$Var1, 1,2)
manf$dir <- "upregulated with age"
manf$dir[manf$Var1 %in% gm$marker[gm$dir =="downregulated with age"]] <- "downregulated with age"
manf$dm <- paste(substr(manf$dir, 1,1), manf$mk)
ggplot(manf, aes(x=mk, y=value, colour=type)) +geom_point(shape=95, size=4)  +scale_color_manual(values=c("cornflower blue", "red3", "forest green"), name= "Age", labels=c("Old", "Young", "Regenerated Old")) +scale_y_log10()
ggplot(manf, aes(x=mk, y=value, colour=type, fill=dir)) +
geom_boxplot()+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2) +
scale_fill_manual(values=c("white", "dark grey"))  +
scale_color_manual(values=c("cornflower blue", "forest green",  "red3")) +
theme(axis.text.x = element_text(angle = 60, hjust =0.5, size=7)) +
facet_wrap(~dir, ncol=1, scales="free_x")
ggplot(manf, aes(x=value, fill=type)) +geom_density()  +scale_fill_manual(values=c("cornflower blue",  "red3", "forest green"), name= "Age", labels=c("Old", "Young", "Regenerated Old")) +scale_x_log10()
ggplot(manf, aes(x=value, fill=type)) +
geom_density(alpha=0.5)  +
scale_fill_manual(values=c("cornflower blue",  "red3", "forest green"), name= "Age", labels=c("Old", "Young", "Regenerated Old")) +
scale_x_log10()
ggplot(manf, aes(x=value, fill=type)) +
geom_density(alpha=0.5)  +
scale_fill_manual(values=c("cornflower blue",  "red3", "forest green"), name= "Age", labels=c("Old", "Young", "Regenerated Old")) +
scale_x_log10() +
facet_wrap(~dir, ncol=1  )
View(ctg3to8)
re <- ctg3to8[,c(37:48,61:69)]
View(re)
an <- ctg3to8/rowMeans(ctg3to8)
re <- an[,c(37:48,61:69)]
mre <- melt(re)
mre$sample <- substr(mre$)
View(mre)
an <- ctg3to8/rowMeans(ctg3to8)
subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
mre <- melt(re)
mre$sample <- substr(mre$Var2,1,1)
an <- ctg3to8/rowMeans(ctg3to8)
an <-subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
mre <- melt(re)
mre$sample <- substr(mre$Var2,1,1)
an <- ctg3to8/rowMeans(ctg3to8)
an <-subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
mre <- melt(re)
mre$sample <- substr(mre$Var2,1,1)
mre$dir <- "upregulated with age"
mre$dir[mre$Var1 %in% gm$marker[gm$dir =="downregulated with age"]] <- "downregulated with age"
View(mre)
mre$type <- substr(mre$Var2,2,length(mre$Var2))
View(mre)
ggplot(data=mre, aes(x=type, y=value)) +
geom_point(shape=95) +
facet_wrap(~marker)
an <- ctg3to8/rowMeans(ctg3to8)
an <-subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
mre <- melt(re)
mre$sample <- substr(mre$Var2,1,1)
mre$type <- substr(mre$Var2,2,length(mre$Var2))
mre$mk <- substr(mre$Var1, 1,2)
mre$dir <- "upregulated with age"
mre$dir[mre$Var1 %in% gm$marker[gm$dir =="downregulated with age"]] <- "downregulated with age"
ggplot(data=mre, aes(x=type, y=value)) +
geom_point(shape=95) +
facet_wrap(~mk)
an <- ctg3to8/rowMeans(ctg3to8)
an <-subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
mre <- melt(re)
mre$sample <- substr(mre$Var2,1,1)
mre$type <- substr(mre$Var2,2,length(mre$Var2))
mre$mk <- substr(mre$Var1, 1,2)
mre$dir <- "upregulated with age"
mre$dir[mre$Var1 %in% gm$marker[gm$dir =="downregulated with age"]] <- "downregulated with age"
ggplot(data=mre, aes(x=type, y=value)) +
geom_point(shape=95) +
facet_wrap(~mk)
ggplot(data=mre, aes(x=type, y=value)) +
geom_point(shape=95)
ggplot(data=mre, aes(colour=type, y=value)) +
geom_point(shape=95, size=8)
ggplot(data=mre, aes(colour=type, x=sample, y=value)) +
geom_point(shape=95, size=8)
ggplot(data=mre, aes(colour=type, x=sample, y=value)) +
geom_point(shape=95, size=8) +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)
ggplot(data=mre, aes(colour=type, x=sample, y=value)) +
geom_point(shape=95, size=8, alpha=0.5) +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)
an <- ctg3to8/rowMeans(ctg3to8)
an <-subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
mre <- melt(re)
mre$sample <- substr(mre$Var2,1,1)
mre$type <- substr(mre$Var2,2,length(mre$Var2))
mre$mk <- substr(mre$Var1, 1,2)
mre$dir <- "upregulated with age"
mre$dir[mre$Var1 %in% gm$marker[gm$dir =="downregulated with age"]] <- "downregulated with age"
ggplot(data=mre, aes(colour=type, x=mk, y=value)) +
geom_point(shape=95, size=8, alpha=0.5) +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
facet_wrap(~sample, ncol=1)
an <- ctg3to8/rowMeans(ctg3to8)
an <-subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
mre <- melt(re)
mre$sample <- substr(mre$Var2,1,1)
mre$type <- substr(mre$Var2,2,length(mre$Var2))
mre$mk <- substr(mre$Var1, 1,2)
mre$dir <- "upregulated with age"
mre$dir[mre$Var1 %in% gm$marker[gm$dir =="downregulated with age"]] <- "downregulated with age"
ggplot(data=mre, aes(colour=type, x=mk, y=value)) +
geom_point(shape=95, size=8, alpha=0.5) +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust =0.5, size=7))
ggplot(data=mre, aes(colour=type, x=mk, y=value)) +
geom_point(shape=95, size=8, alpha=0.5) +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust =0.5, size=7))
mre$md <- paste(substr(mre$dir, 1,2), mre$mk)
ggplot(data=mre, aes(colour=type, x=mk, y=value)) +
geom_point(shape=95, size=8, alpha=0.5) +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust =0.5, size=7))
ggplot(data=mre, aes(colour=type, x=md, y=value)) +
geom_point(shape=95, size=8, alpha=0.5) +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust =0.5, size=7))
ggplot(data=mre, aes(colour=type, x=md, y=value)) +
geom_point() +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60))
ggplot(data=mre, aes(colour=type, x=md, y=value)) +
geom_point() +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))
ggplot(data=mre, aes(colour=type, x=md, y=value)) +
geom_boxplot() +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))
ggplot(data=mre, aes(colour=type, x=md, y=value)) +
geom_boxplot() +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))
ggplot(data=mre, aes(colour=type, x=md, y=value, fill=dir)) +
geom_boxplot() +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
scale_fill_manual(values=c("white", "dark grey"))
ggplot(data=mre, aes(colour=type, x=md, y=value, fill=dir)) +
geom_boxplot(outlier.shape=NA) +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
scale_fill_manual(values=c("white", "dark grey"))
ggplot(data=mre, aes(colour=type, x=md, y=value)) +
geom_point() +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~sample)
ggplot(data=mre, aes(colour=type, x=value)) +
geom_density(alpha=0.5) +
scale_x_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue"))
ggplot(data=mre, aes(fill=type, x=value)) +
geom_density(alpha=0.5) +
scale_x_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_fill_manual(values=c("cornflower blue", "forest green",  "dark blue"))
ggplot(data=mre, aes(fill=type, x=value)) +
geom_density(alpha=0.5) +
scale_x_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_fill_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
facet_wrap(~dir, ncol=1)
ggplot(data=mre, aes(colour=type, x=md, y=value)) +
geom_point() +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))
re <- subset(re, sampleinfo$qual[sampleinfo$sample %in% colnames(re)] != "ok")
View(re)
re <- an[,c(37:48,61:69)]
re <- t(subset(t(re), sampleinfo$qual[sampleinfo$sample %in% colnames(re)] != "ok"))
View(re)
re <- an[,c(37:48,61:69) & sampleinfo$qual == "ok"]
re <- an[,c(37:48,61:69) & sampleinfo$qual[,c(37:48,61:69)] == "ok"]
sampleinfo$qual[,c(37:48,61:69)]
re <- an[,c(37:48,61:69) & sampleinfo$qual[c(37:48,61:69)] == "ok"]
View(re)
re <- an[,c(37:48,61:69) | sampleinfo$qual[c(37:48,61:69)] == "ok"]
an <- ctg3to8/rowMeans(ctg3to8)
an <-subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
msi <- sampleinfo[,c(37:48,61:69)]
View(sampleinfo)
msi <- subset(sampleinfo$sample %in% colnames(re)
re <- t(subset(t(re), sampleinfo$qual[sampleinfo$sample %in% colnames(re)] != "ok"))
msi <- subset(sampleinfo$sample %in% colnames(re))
msi <- subset(sampleinfo, sampleinfo$sample %in% colnames(re))
View(msi)
re <- re[msi$qual=="ok"]
an <- ctg3to8/rowMeans(ctg3to8)
an <-subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
msi <- subset(sampleinfo, sampleinfo$sample %in% colnames(re))
re <- re[, msi$qual=="ok"]
View(re)
mre <- melt(re)
mre$sample <- substr(mre$Var2,1,1)
mre$type <- substr(mre$Var2,2,length(mre$Var2))
mre$mk <- substr(mre$Var1, 1,2)
mre$dir <- "upregulated with age"
mre$dir[mre$Var1 %in% gm$marker[gm$dir =="downregulated with age"]] <- "downregulated with age"
mre$md <- paste(substr(mre$dir, 1,2), mre$mk)
ggplot(data=mre, aes(colour=type, x=md, y=value)) +
geom_point() +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))
ggplot(data=mre, aes(colotur=type, x=md, y=value, fill=dir)) +
geom_boxplot(outlier.shape=NA) +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
scale_fill_manual(values=c("white", "dark grey"))
ggplot(data=mre, aes(colotur=type, x=md, y=value, fill=dir)) +
geom_boxplot(outlier.shape=NA) +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
scale_fill_manual(values=c("white", "dark grey"))
an <- ctg3to8/rowMeans(ctg3to8)
an <-subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
msi <- subset(sampleinfo, sampleinfo$sample %in% colnames(re))
re <- re[, msi$qual=="ok"]
mre <- melt(re)
mre$sample <- substr(mre$Var2,1,1)
mre$type <- substr(mre$Var2,2,length(mre$Var2))
mre$mk <- substr(mre$Var1, 1,2)
mre$dir <- "upregulated with age"
mre$dir[mre$Var1 %in% gm$marker[gm$dir =="downregulated with age"]] <- "downregulated with age"
mre$md <- paste(substr(mre$dir, 1,2), mre$mk)
ggplot(data=mre, aes(colour=type, x=md, y=value)) +
geom_point() +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))
ggplot(data=mre, aes(colotur=type, x=md, y=value, fill=dir)) +
geom_boxplot(outlier.shape=NA) +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
scale_fill_manual(values=c("white", "dark grey"))
ggplot(data=mre, aes(colour=type, x=md, y=value, fill=dir)) +
geom_boxplot(outlier.shape=NA) +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
scale_fill_manual(values=c("white", "dark grey"))
ggplot(data=mre, aes(colour=type, x=md, y=value)) +
geom_point() +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
stat_summary_bin()
ggplot(data=mre, aes(colour=type, x=md, y=value)) +
geom_point() +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
stat_summary_bin()
ggplot(data=mre, aes(colour=type, x=md, y=value, fill=dir)) +
geom_boxplot(outlier.shape=NA) +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
scale_fill_manual(values=c("white", "dark grey"))
ggplot(data=mre, aes(colour=type, x=md, y=value)) +
geom_point() +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~sample)
ggplot(data=mre, aes(fill=type, x=value)) +
geom_density(alpha=0.5) +
scale_x_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_fill_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
facet_wrap(~dir, ncol=1)
View(sampleinfo)
sampleinfo$qual[c(1,7,8, 25, 43, 52, 66)] <- "bad"
an <- ctg3to8/rowMeans(ctg3to8)
an <-subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
msi <- subset(sampleinfo, sampleinfo$sample %in% colnames(re))
re <- re[, msi$qual=="ok"]
mre <- melt(re)
mre$sample <- substr(mre$Var2,1,1)
mre$type <- substr(mre$Var2,2,length(mre$Var2))
mre$mk <- substr(mre$Var1, 1,2)
mre$dir <- "upregulated with age"
mre$dir[mre$Var1 %in% gm$marker[gm$dir =="downregulated with age"]] <- "downregulated with age"
mre$md <- paste(substr(mre$dir, 1,2), mre$mk)
ggplot(data=mre, aes(colour=type, x=md, y=value)) +
geom_point() +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
stat_summary_bin()
ggplot(data=mre, aes(colour=type, x=md, y=value, fill=dir)) +
geom_boxplot(outlier.shape=NA) +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
scale_fill_manual(values=c("white", "dark grey"))
ggplot(data=mre, aes(colour=type, x=md, y=value)) +
geom_point() +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~sample)
ggplot(data=mre, aes(fill=type, x=value)) +
geom_density(alpha=0.5) +
scale_x_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_fill_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
facet_wrap(~dir, ncol=1)
save(file="nstrnov17.Rdata")
save.image("~/nstringnov17/ctg3and4/nstrnov17.Rdata.RData")
load("~/.RData")
save.image("~/nstringnov17/nstringnov17.Rdata.RData")
