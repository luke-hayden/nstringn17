ggplot(mc36, aes(y=value, x=Var1, colour=isg)) +geom_point(alpha=0.3) +facet_wrap(~Var2) +scale_y_log10()
#ggplot(mc36, aes(y=value, x=Var1, colour=exp)) +geom_point(alpha=0.3, shape=95, size=5) +facet_wrap(~Var2) +scale_y_log10() + theme(  axis.text.x = element_blank())
log <- sampleinfo$ctg %in% c(3,4,5,7) & sampleinfo$qual == "ok" & sampleinfo$reg == ""
bcmin <- ctg3to8[,log== TRUE]
bcmin.groups <- subset(paste(sampleinfo$type, sampleinfo$sex), log==TRUE)
bcmin <- subset(bcmin, rownames(bcmin) %in% gm$marker)
tbc <- t(bcmin)
tbc <- tbc[,colSums(tbc) > 0]
bc.pca <- prcomp(tbc,center = TRUE,scale. = TRUE)
bc.groups <- bcmin.groups
ggbiplot(bc.pca, obs.scale = 1, var.scale = 1, ellipse = FALSE, circle = TRUE, var.axes=FALSE, labels=rownames(tbc), groups=bc.groups)+ggtitle("PCA of O vs Y: 61 chosen markers")+ scale_colour_manual(values=c("cornflower blue","dark blue",  "red3", "orangered"))
log <- sampleinfo$sex =="M" & sampleinfo$ctg %in% c(3,4,5,7) & sampleinfo$qual == "ok" & sampleinfo$reg == ""
bcmin <- ctg3to8[,log== TRUE]
bcmin.groups <- subset(sampleinfo$type, log==TRUE)
bcmin <- subset(bcmin, rownames(bcmin) %in% gm$marker)
tbc <- t(bcmin)
tbc <- tbc[,colSums(tbc) > 0]
bc.pca <- prcomp(tbc,center = TRUE,scale. = TRUE)
bc.groups <- bcmin.groups
ggbiplot(bc.pca, obs.scale = 1, var.scale = 1, ellipse = FALSE, circle = TRUE, var.axes=FALSE, labels=rownames(tbc), groups=bc.groups)+ggtitle("PCA of O vs Y: 61 chosen markers")+ scale_colour_manual(values=c("cornflower blue", "red3"))
an <- ctg3to8
an <-subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
re <- re/rowMeans(re)
msi <- subset(sampleinfo, sampleinfo$sample %in% colnames(re))
re <- re[, msi$qual=="ok"]
mre <- melt(re)
mre$sample <- substr(mre$Var2,1,1)
mre$type <- substr(mre$Var2,2,length(mre$Var2))
mre$mk <- substr(mre$Var1, 1,2)
mre$dir <- "upregulated with age"
mre$dir[mre$Var1 %in% gm$marker[gm$dir =="downregulated with age"]] <- "downregulated with age"
mre$md <- paste(substr(mre$dir, 1,2), mre$mk)
ggplot(data=mre, aes(colour=type, x=md, y=value)) +
geom_point() +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
stat_summary_bin()
ggplot(data=mre, aes(colour=type, x=md, y=value)) +
geom_point() +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue"))+
theme(axis.text.x = element_text(angle = 60, hjust=1))
ggplot(data=mre, aes(colour=type, x=md, y=value, fill=dir)) +
geom_boxplot(outlier.shape=NA) +
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
#  facet_wrap(~sample, ncol=1) +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue")) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
scale_fill_manual(values=c("white", "dark grey"))
an <-subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
View(re)
mre <- melt(re)
View(mre)
mre$sample <- substr(mre$Var2, 1,1)
mre$type <- substr(mre$Var2, 2, length(mre$Var2))
View(mre)
cmre <- acast(Var1 ~ sample)
cmre <- acast(mre, Var1 ~ sample)
View(cmre)
dcast(data = mre,formula = id~variable,fun.aggregate = sum,value.var = "value")
dcast(data = mre,formula = id~Var2,fun.aggregate = sum,value.var = "value")
View(mre)
subset(mre, mre$type == "bef")
cmre <- rbind(cmre, subset(mre, mre$type == "un"))
an <-subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
mre <- melt(re)
mre$sample <- substr(mre$Var2, 1,1)
mre$type <- substr(mre$Var2, 2, length(mre$Var2))
subset(mre, mre$type == "bef")
cmre <- subset(mre, mre$type == "bef")
cmre <- rbind(cmre, subset(mre, mre$type == "un"))
View(cmre)
subset(mre, mre$type == "un")
cmre <- rbind(cmre, subset(mre, mre$type == "un")$value)
cmre <- data.frame(bef = mre$value[mre$type == "bef"], un = mre$value[mre$type == "un"], reg =mre$value[mre$type == "reg"])
View(cmre)
cmre <- data.frame(sample <-mre$sample[mre$type == "bef"], bef = mre$value[mre$type == "bef"], un = mre$value[mre$type == "un"], reg =mre$value[mre$type == "reg"])
View(cmre)
View(mre)
cmre <- data.frame(marker = mre$Var1[mre$type == "bef"], sample =mre$sample[mre$type == "bef"], bef = mre$value[mre$type == "bef"], un = mre$value[mre$type == "un"], reg =mre$value[mre$type == "reg"])
View(cmre)
cmre <- data.frame(bef = mre$value[mre$type == "bef"], un = mre$value[mre$type == "un"], reg =mre$value[mre$type == "reg"])
cmren <- data.frame(marker = mre$Var1[mre$type == "bef"], sample =mre$sample[mre$type == "bef"], bef = mre$value[mre$type == "bef"]mre$value[mre$type == "bef"], un = mre$value[mre$type == "un"]/mre$value[mre$type == "bef"], reg =mre$value[mre$type == "reg"]/mre$value[mre$type == "bef"])
cmren <- data.frame(marker = mre$Var1[mre$type == "bef"], sample =mre$sample[mre$type == "bef"], bef = mre$value[mre$type == "bef"]/mre$value[mre$type == "bef"], un = mre$value[mre$type == "un"]/mre$value[mre$type == "bef"], reg =mre$value[mre$type == "reg"]/mre$value[mre$type == "bef"])
View(cmren)
View(cmren)
an <-subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
View(re)
mre <- melt(re, id.vars=c("dir"))
mre$sample <- substr(mre$Var2, 1,1)
mre$type <- substr(mre$Var2, 2, length(mre$Var2))
an <-subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
re$dir <- gm$dir
mre <- melt(re, id.vars=c("dir"))
mre$sample <- substr(mre$Var2, 1,1)
mre$type <- substr(mre$Var2, 2, length(mre$Var2))
mre <- melt(re, id.vars=c("dir"))
View(mre)
an <-subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
re$dir <- gm$dir
mre<- melt(re)
View(mre)
an <-subset(an, rownames(an) %in% gm$marker)
re <- an[,c(37:48,61:69)]
mre<- melt(re)
View(re)
re <- as.data.frame(an[,c(37:48,61:69)])
re$dir <- gm$dir
gm$hk <- !(gm$marker%in% rownames(ct5and6.norm))
gm$hk <- !(gm$marker%in% rownames(ctg5and6.norm))
View(gm)
an <-subset(an, rownames(an) %in% gm$marker)
re <- as.data.frame(an[,c(37:48,61:69)])
re$dir <- gm[gm$dir != "housekeeping"]$dir
re$dir <- subset(gm, gm$dir != "housekeeping")$dir
View(re)
mre <- melt(re, id.vars=c("dir"))
mre$sample <- substr(mre$Var2, 1,1)
mre$type <- substr(mre$Var2, 2, length(mre$Var2))
mre <- melt(re, id.vars=c("dir"))
View(mre)
mre$sample <- substr(mre$Var2, 1,1)
View(mre)
re$marker <- rownames(re)
mre <- melt(re, id.vars=c("dir", "marker"))
mre <- melt(re, id.vars=c("dir", "marker"))
mre$sample <- substr(mre$variable, 1,1)
mre$type <- substr(mre$variable, 2, length(mre$variable))
View(mre)
cmren <- data.frame(marker = mre$Var1[mre$type == "bef"], sample =mre$sample[mre$type == "bef"], dir = mre$ bef = mre$value[mre$type == "bef"]/mre$value[mre$type == "bef"], un = mre$value[mre$type == "un"]/mre$value[mre$type == "bef"], reg =mre$value[mre$type == "reg"]/mre$value[mre$type == "bef"])
cmren <- data.frame(marker = mre$marker[mre$type == "bef"], sample =mre$sample[mre$type == "bef"], dir = mre$ bef = mre$value[mre$type == "bef"]/mre$value[mre$type == "bef"], un = mre$value[mre$type == "un"]/mre$value[mre$type == "bef"], reg =mre$value[mre$type == "reg"]/mre$value[mre$type == "bef"])
cmren <- data.frame(marker = mre$marker[mre$type == "bef"], sample =mre$sample[mre$type == "bef"], dir = mre$bef = mre$value[mre$type == "bef"]/mre$value[mre$type == "bef"], un = mre$value[mre$type == "un"]/mre$value[mre$type == "bef"], reg =mre$value[mre$type == "reg"]/mre$value[mre$type == "bef"])
cmren <- data.frame(marker = mre$marker[mre$type == "bef"], sample =mre$sample[mre$type == "bef"])
View(cmren)
cmren <- data.frame(marker = mre$marker[mre$type == "bef"], sample =mre$sample[mre$type == "bef"], dir = mre$dir[mre$type == "bef"],mre$bef = mre$value[mre$type == "bef"]/mre$value[mre$type == "bef"], un = mre$value[mre$type == "un"]/mre$value[mre$type == "bef"], reg =mre$value[mre$type == "reg"]/mre$value[mre$type == "bef"])
cmren <- data.frame(marker = mre$marker[mre$type == "bef"], sample =mre$sample[mre$type == "bef"], dir = mre$dir[mre$type == "bef"])
cmren <- data.frame(marker = mre$marker[mre$type == "bef"], sample =mre$sample[mre$type == "bef"], dir = mre$dir[mre$type == "bef"],mre$bef = mre$value[mre$type == "bef"]/mre$value[mre$type == "bef"])
cmren <- data.frame(marker = mre$marker[mre$type == "bef"], sample =mre$sample[mre$type == "bef"], dir = mre$dir[mre$type == "bef"],bef= mre$value[mre$type == "bef"]/mre$value[mre$type == "bef"])
View(cmren)
cmren <- data.frame(marker = mre$marker[mre$type == "bef"], sample =mre$sample[mre$type == "bef"], dir = mre$dir[mre$type == "bef"],bef= mre$value[mre$type == "bef"]/mre$value[mre$type == "bef"], un = mre$value[mre$type == "un"]/mre$value[mre$type == "bef"], reg =mre$value[mre$type == "reg"]/mre$value[mre$type == "bef"])
cmren <- data.frame(marker = mre$marker[mre$type == "bef"], sample =mre$sample[mre$type == "bef"], dir = mre$dir[mre$type == "bef"],bef= mre$value[mre$type == "bef"]/mre$value[mre$type == "bef"], un = mre$value[mre$type == "un"]/mre$value[mre$type == "bef"], reg =mre$value[mre$type == "reg"]/mre$value[mre$type == "bef"])
cmren <- subset(cmren, cmren$bef ==1)
View(cmren)
View(cmren)
mcmren <- melt(cmren, id.vars=c("marker", "sample", "dir"))
View(mcmren)
ggplot(mcmren, aes(x=md, y=value, fill=md, colour=variable)) +
geom_point() +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_x_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))
mcmren$md <- paste(substr(mcmren$dir,1,2), substr(mcmren$marker,1,2)
ggplot(mcmren, aes(x=md, y=value, fill=md, colour=variable)) +
mcmren$md <- paste(substr(mcmren$dir,1,2), substr(mcmren$marker,1,2))
ggplot(mcmren, aes(x=md, y=value, fill=md, colour=variable)) +
geom_point() +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_x_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))
ggplot(mcmren, aes(x=md, y=value, fill=md, colour=variable)) +
geom_point() +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))
ggplot(mcmren, aes(x=md, y=value, fill=md, colour=variable)) +
geom_point() +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir)
ggplot(mcmren, aes(x=md, y=value, fill=md, colour=variable)) +
geom_point() +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x")
ggplot(mcmren, aes(x=md, y=value, fill=md, colour=variable)) +
geom_boxplot() +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x")
ggplot(mcmren, aes(x=md, y=value, fill=dir, colour=variable)) +
geom_boxplot() +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x")
ggplot(mcmren, aes(x=md, y=value, fill=dir, colour=variable)) +
geom_boxplot() +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))
ggplot(mcmren, aes(x=md, y=value, fill=dir, colour=variable)) +
geom_boxplot() +
scale_color_manual(values=c("cornflower blue"  "dark blue", "forest green",))+
ggplot(mcmren, aes(x=md, y=value, fill=dir, colour=variable)) +
geom_boxplot() +
scale_color_manual(values=c("cornflower blue"  "dark blue", "forest green",))+
ggplot(mcmren, aes(x=md, y=value, fill=dir, colour=variable)) +
geom_boxplot() +
scale_color_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))
ggplot(mcmren, aes(x=md, y=value, fill=dir, colour=variable)) +
geom_boxplot() +
scale_color_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x")
ggplot(mcmren, aes(x=md, y=value, fill=variable)) +
geom_boxplot() +
scale_fill_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x")
ggplot(mcmren, aes(x=md, y=value,colour=variable,  fill=variable)) +
geom_boxplot() +
scale_colour_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
scale_fill_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x", ncol=1)
ggplot(mcmren, aes(x=md, y=value,colour=variable)) +
geom_point(shape=95, size=5) +
scale_colour_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x", ncol=1)
ggplot(mcmren, aes(x=md, y=value,colour=variable)) +
geom_point(shape=95, size=8, alpha=0.5) +
scale_colour_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x", ncol=1)
ggplot(mcmren, aes(x=md, y=value,colour=variable)) +
geom_point(shape=95, size=12, alpha=0.5) +
scale_colour_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x", ncol=1)
ggplot(mcmren, aes(x=md, y=value,colour=variable)) +
geom_point(shape=95, size=12, alpha=0.5) +
scale_colour_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~variable, scales="free_x", ncol=1)
ggplot(mcmren, aes(x=md, y=value,colour=variable)) +
geom_point(shape=95, size=12, alpha=0.5) +
scale_colour_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x", ncol=1)
ggplot(mcmren, aes(x=md, y=value,colour=variable)) +
geom_point(shape=95, size=12, alpha=0.5) +
scale_colour_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_hline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x", ncol=1)
ggplot(mcmren, aes(x=md, y=value,colour=variable)) +
geom_point(shape=95, size=12, alpha=0.5) +
scale_colour_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x", ncol=1)
ggplot(mcmren, aes(x=md, y=value,colour=variable,  fill=variable)) +
geom_boxplot() +
scale_colour_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
scale_fill_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x", ncol=1)
ggplot(mcmren, aes(x=md, y=value,colour=variable,  fill=variable)) +
geom_boxplot() +
scale_colour_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
scale_fill_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x", ncol=1)
t.test(cmre$bef, cmre$un)
t.test(cmren$bef, cmren$un)
t.test(cmren$bef, cmren$reg)
cmre <- data.frame(marker = mre$marker[mre$type == "bef"], sample =mre$sample[mre$type == "bef"], dir = mre$dir[mre$type == "bef"],bef= mre$value[mre$type == "bef"], un = mre$value[mre$type == "un"], reg =mre$value[mre$type == "reg"])
cmre <- data.frame(marker = mre$marker[mre$type == "bef"], sample =mre$sample[mre$type == "bef"], dir = mre$dir[mre$type == "bef"],bef= mre$value[mre$type == "bef"], un = mre$value[mre$type == "un"], reg =mre$value[mre$type == "reg"])
cmre <- subset(cmre, cmre$dir == "upregulated with age" )
t.test(cmre$bef, cmre$un)
t.test(cmre$bef, cmre$reg)
cmre <- data.frame(marker = mre$marker[mre$type == "bef"], sample =mre$sample[mre$type == "bef"], dir = mre$dir[mre$type == "bef"],bef= mre$value[mre$type == "bef"], un = mre$value[mre$type == "un"], reg =mre$value[mre$type == "reg"])
cmre <- subset(cmre, cmre$dir == "downregulated with age" )
t.test(cmre$bef, cmre$reg)
cmre$reg
t.test(cmren$bef[cmren$dir == "downregulated with age"], cmren$reg[cmren$dir == "downregulated with age"])
t.test(cmren$bef[cmren$dir == "downregulated with age"], cmren$un[cmren$dir == "downregulated with age"])
an <-subset(an, rownames(an) %in% gm$marker)
re <- as.data.frame(an[,c(37:48,61:69)])
re$dir <- subset(gm, gm$dir != "housekeeping")$dir
re$marker <- rownames(re)
mre <- melt(re, id.vars=c("dir", "marker"))
mre$sample <- substr(mre$variable, 1,1)
mre$type <- substr(mre$variable, 2, length(mre$variable))
cmren <- data.frame(marker = mre$marker[mre$type == "bef"], sample =mre$sample[mre$type == "bef"], dir = mre$dir[mre$type == "bef"],bef= mre$value[mre$type == "bef"]/mre$value[mre$type == "bef"], un = mre$value[mre$type == "un"]/mre$value[mre$type == "bef"], reg =mre$value[mre$type == "reg"]/mre$value[mre$type == "bef"])
cmren <- subset(cmren, cmren$bef ==1)
mcmren <- melt(cmren, id.vars=c("marker", "sample", "dir"))
mcmren$md <- paste(substr(mcmren$dir,1,2), substr(mcmren$marker,1,2))
ggplot(mcmren, aes(x=md, y=value, fill=md, colour=variable)) +
geom_point() +
scale_color_manual(values=c("cornflower blue", "forest green",  "dark blue"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x")
ggplot(mcmren, aes(x=md, y=value,colour=variable,  fill=variable)) +
geom_boxplot() +
scale_colour_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
scale_fill_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x", ncol=1)
ggplot(mcmren, aes(x=md, y=value,colour=variable)) +
geom_point(shape=95, size=12, alpha=0.5) +
scale_colour_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x", ncol=1)
ggplot(mcmren, aes(x=md, y=value,colour=variable,  fill=variable)) +
geom_boxplot(outlier.shape=NA) +
scale_colour_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
scale_fill_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x", ncol=1)
ggplot(mcmren, aes(x=md, y=value,colour=variable)) +
geom_point( alpha=0.5) +
scale_colour_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x", ncol=1)
ggplot(mcmren, aes(x=md, y=value,colour=variable)) +
geom_point( alpha=0.5) +
scale_colour_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x", ncol=1)
ggplot(mcmren, aes(x=md, y=value,colour=variable,  fill=variable)) +
geom_boxplot(outlier.shape=NA) +
scale_colour_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
scale_fill_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_hline(yintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
theme(axis.text.x = element_text(angle = 60, hjust=1))+
facet_wrap(~dir, scales="free_x", ncol=1)
ggplot(mcmren, aes(x=value,colour=variable)) +
geom_density( alpha=0.5) +
scale_colour_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))
ggplot(mcmren, aes(x=value,fill=variable)) +
geom_density( alpha=0.5) +
scale_fill_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_y_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))
ggplot(mcmren, aes(x=value,fill=variable)) +
geom_density( alpha=0.5) +
scale_fill_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_x_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))
ggplot(mcmren, aes(x=value,fill=variable)) +
geom_density( alpha=0.5) +
scale_fill_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_x_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4))
ggplot(mcmren, aes(x=value,fill=variable)) +
geom_density( alpha=0.5) +
scale_fill_manual(values=c("cornflower blue" , "dark blue", "forest green"))+
geom_vline(xintercept=1, colour = "black", linetype=2)+
scale_x_continuous(trans='log2', breaks=c(0,0.25,0.5,1,2,4)) +
facet_wrap(~dir, scales="free_x", ncol=1)
setwd("~/Documents/nstringnov17/ctg9")
ct9.raw <- read.markup.RCC()
setwd("~/Documents/nstringnov17/ctg9")
ct9.raw <- read.markup.RCC()
ctg9.norm <- NanoStringNorm(x = ct9raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg9.norm <- NanoStringNorm(x = ct9.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
colnames(ctg9.norm) <- c("LFIC", "LFID", "OmID", "10mIA", "n", "20mIC", "Ibef", "Iun", "Ireg", "Kbef", "Kun", "Kreg")
setwd("~/Documents/nstringnov17/ctg7and8hi")
ct7and8hi.raw <- read.markup.RCC()
setwd("~/Documents/nstringnov17/ctg7and8hi")
ct7and8hi.raw <- read.markup.RCC()
ctg7and8hi.norm <- NanoStringNorm(x = ct7and8hi.raw, anno = NA, CodeCount ='sum', Background ="mean", SampleContent ='housekeeping.sum', round.values = FALSE, take.log = FALSE,return.matrix.of.endogenous.probes = TRUE);
ctg3to9 <- cbind(ctg3and4.norm, ctg5and6hi.norm, ctg7and8hi.norm, ctg9.norm)
View(ctg3to9)
colnames(ctg5and6.norm) <- c("SFPA", "SFPB", "LFPA", "LFPB", "SMPA", "SMPB", "LMPA", "LMPB", "LMIA", "LMIB", "LMIC", "LMID", "Abef", "Aun", "Areg", "Bbef", "Bun", "Breg", "Cbef", "Cun", "Creg", "Dbef", "Dun", "Dreg")
colnames(ctg5and6hi.norm) <-  c("SFPA", "SFPB", "LFPA", "LFPB", "SMPA", "SMPB", "LMPA", "LMPB", "LMIA", "LMIB", "LMIC", "LMID", "Abef", "Aun", "Areg", "Bbef", "Bun", "Breg", "Cbef", "Cun", "Creg", "Dbef", "Dun", "Dreg")
colnames(ctg7and8.norm) <- c("SFPC","SFPD", "LFPC", "LFPD", "SMPC", "SMPD","LMPC", "LMPD", "0mPA", "0mPB", "10mPA", "20mPA", "Ebef", "Eun", "Ereg", "Fbef", "Fun", "Freg", "Gbef", "Gun", "Greg", "LFIA", "LFIB", "20mPB")
colnames(ctg7and8hi.norm) <-c("SFPC","SFPD", "LFPC", "LFPD", "SMPC", "SMPD","LMPC", "LMPD", "0mPA", "0mPB", "10mPA", "20mPA", "Ebef", "Eun", "Ereg", "Fbef", "Fun", "Freg", "Gbef", "Gun", "Greg", "LFIA", "LFIB", "20mPB")
colnames(ctg3and4.norm) <- c("O1a", "O2a", "Y1a", "Y2a", "OR1a", "OR2a", "YR1a", "YR2a", "FY5a", "FY6a", "FO5a", "FO7a", "O1b", "O2b", "Y1b", "Y2b", "OR1b", "OR2b", "YR1b", "YR2b", "FY7", "FY8", "FO8", "FO9")
colnames(ctg9.norm) <- c("LFIC", "LFID", "OmID", "10mIA", "n", "20mIC", "Ibef", "Iun", "Ireg", "Kbef", "Kun", "Kreg")
ctg3to9 <- cbind(ctg3and4.norm, ctg5and6hi.norm, ctg7and8hi.norm, ctg9.norm)
View(ctg3to9)
View(ctg9.norm)
c(rep("F", 28), rep("M", 8), rep("F", 16), rep("M", 4), rep("F", 28))
age=c(rep(c("O", "O", "Y", "Y", "O", "O", "Y", "Y","Y", "Y", "O", "O"), 2), rep(c("Y", "Y", "O", "O", "Y", "Y", "O", "O", "O", "O", "O", "O", rep("O", 12)), 2), rep("O", 12))
c(rep(c("O", "O", "Y", "Y", "O", "O", "Y", "Y","Y", "Y", "O", "O"), 2), rep(c("Y", "Y", "O", "O", "Y", "Y", "O", "O", "O", "O", "O", "O", rep("O", 12)), 2), rep("O", 12))
sampleinfo <- data.frame(sample=colnames(ctg3to8), sex=c(rep("F", 28), rep("M", 8), rep("F", 16), rep("M", 4), rep("F", 28)), age=c(rep(c("O", "O", "Y", "Y", "O", "O", "Y", "Y","Y", "Y", "O", "O"), 2), rep(c("Y", "Y", "O", "O", "Y", "Y", "O", "O", "O", "O", "O", "O", rep("O", 12)), 2), rep("O", 12)), reg=c(rep(c(rep("", 4), rep("R", 4), rep("", 4)), 2), c(rep("", 12), rep(c("", "", "R"),4 )   ), c(rep("", 12), rep(c("", "", "R"),3 )   ), rep("",15 )) , ctg=c(rep("3", 12), rep("4", 12), rep("5", 12), rep("6", 12), rep("7", 12), rep("8", 12)), rep("9", 12))  )
sampleinfo <- data.frame(sample=colnames(ctg3to8), sex=c(rep("F", 28), rep("M", 8), rep("F", 16), rep("M", 4), rep("F", 28)), age=c(rep(c("O", "O", "Y", "Y", "O", "O", "Y", "Y","Y", "Y", "O", "O"), 2), rep(c("Y", "Y", "O", "O", "Y", "Y", "O", "O", "O", "O", "O", "O", rep("O", 12)), 2), rep("O", 12)), reg=c(rep(c(rep("", 4), rep("R", 4), rep("", 4)), 2), c(rep("", 12), rep(c("", "", "R"),4 )   ), c(rep("", 12), rep(c("", "", "R"),3 )   ), rep("",15 )) , ctg=c(rep("3", 12), rep("4", 12), rep("5", 12), rep("6", 12), rep("7", 12), rep("8", 12)), rep("9", 12))
sampleinfo <- data.frame(sample=colnames(ctg3to9), sex=c(rep("F", 28), rep("M", 8), rep("F", 16), rep("M", 4), rep("F", 28)), age=c(rep(c("O", "O", "Y", "Y", "O", "O", "Y", "Y","Y", "Y", "O", "O"), 2), rep(c("Y", "Y", "O", "O", "Y", "Y", "O", "O", "O", "O", "O", "O", rep("O", 12)), 2), rep("O", 12)), reg=c(rep(c(rep("", 4), rep("R", 4), rep("", 4)), 2), c(rep("", 12), rep(c("", "", "R"),4 )   ), c(rep("", 12), rep(c("", "", "R"),3 )   ), rep("",15 )) , ctg=c(rep("3", 12), rep("4", 12), rep("5", 12), rep("6", 12), rep("7", 12), rep("8", 12)), rep("9", 12))
=colnames(ctg3to9)
colnames(ctg3to9)
c(rep("F", 28), rep("M", 8), rep("F", 16), rep("M", 4), rep("F", 28))
c(rep(c("O", "O", "Y", "Y", "O", "O", "Y", "Y","Y", "Y", "O", "O"), 2), rep(c("Y", "Y", "O", "O", "Y", "Y", "O", "O", "O", "O", "O", "O", rep("O", 12)), 2), rep("O", 12))
c(rep(c(rep("", 4), rep("R", 4), rep("", 4)), 2), c(rep("", 12), rep(c("", "", "R"),4 )   ), c(rep("", 12), rep(c("", "", "R"),3 )   ), rep("",15 ))
c(rep("3", 12), rep("4", 12), rep("5", 12), rep("6", 12), rep("7", 12), rep("8", 12)), rep("9", 12))
sampleinfo <- data.frame(sample=colnames(ctg3to9), sex=c(rep("F", 28), rep("M", 8), rep("F", 16), rep("M", 4), rep("F", 28)), age=c(rep(c("O", "O", "Y", "Y", "O", "O", "Y", "Y","Y", "Y", "O", "O"), 2), rep(c("Y", "Y", "O", "O", "Y", "Y", "O", "O", "O", "O", "O", "O", rep("O", 12)), 2), rep("O", 12)), reg=c(rep(c(rep("", 4), rep("R", 4), rep("", 4)), 2), c(rep("", 12), rep(c("", "", "R"),4 )   ), c(rep("", 12), rep(c("", "", "R"),3 )   ), rep("",15 )) , ctg=c(rep("3", 12), rep("4", 12), rep("5", 12), rep("6", 12), rep("7", 12), rep("8", 12)), rep("9", 12))
c(rep("3", 12), rep("4", 12), rep("5", 12), rep("6", 12), rep("7", 12), rep("8", 12)), rep("9", 12)
c(rep("3", 12), rep("4", 12), rep("5", 12), rep("6", 12), rep("7", 12), rep("8", 12), rep("9", 12)
)
sampleinfo <- data.frame(sample=colnames(ctg3to9), sex=c(rep("F", 28), rep("M", 8), rep("F", 16), rep("M", 4), rep("F", 28)), age=c(rep(c("O", "O", "Y", "Y", "O", "O", "Y", "Y","Y", "Y", "O", "O"), 2), rep(c("Y", "Y", "O", "O", "Y", "Y", "O", "O", "O", "O", "O", "O", rep("O", 12)), 2), rep("O", 12)), reg=c(rep(c(rep("", 4), rep("R", 4), rep("", 4)), 2), c(rep("", 12), rep(c("", "", "R"),4 )   ), c(rep("", 12), rep(c("", "", "R"),3 )   ), rep("",15 )) , ctg=c(rep("3", 12), rep("4", 12), rep("5", 12), rep("6", 12), rep("7", 12), rep("8", 12), rep("9", 12))  )
View(ctg3to9)
sampleinfo <- data.frame(sample=colnames(ctg3to9), sex=c(rep("F", 28), rep("M", 8), rep("F", 16), rep("M", 4), rep("F", 28)), age=c(rep(c("O", "O", "Y", "Y", "O", "O", "Y", "Y","Y", "Y", "O", "O"), 2), rep(c("Y", "Y", "O", "O", "Y", "Y", "O", "O", "O", "O", "O", "O", rep("O", 12)), 2), rep("O", 12)), reg=c(rep(c(rep("", 4), rep("R", 4), rep("", 4)), 2), c(rep("", 12), rep(c("", "", "R"),4 )   ), c(rep("", 12), rep(c("", "", "R"),3 )   ), rep("",15 )) , ctg=c(rep("3", 12), rep("4", 12), rep("5", 12), rep("6", 12), rep("7", 12), rep("8", 12), rep("9", 12))  )
sampleinfo$type <- paste(sampleinfo$age, sampleinfo$reg, sep="")
sampleinfo$qual <- "ok"
sampleinfo$qual[c(1,7,8, 25, 43, 52, 66,77)] <- "bad"
mc36 <- melt(cbind(ctg3to8, sampleinfo$qual))
View(mc36)
bind(ctg3to8, sampleinfo$qual)
cbind(ctg3to8, sampleinfo$qual)
rbind(ctg3to8, sampleinfo$qual)
mc36 <- melt(ctg3to8)
mc36$exp <- mc36$value > 1
mc36$isg <- mc36$Var1 %in% gm$marker
View(mc36)
mc36$qual <- mc36$Var1 %in% sampleinfo$marker[sampleinfo$qual == "ok"]
ggplot(mc36, aes(y=value, x=Var1, colour=qual)) +geom_point(alpha=0.3) +facet_wrap(~Var2) +scale_y_log10()
sampleinfo$type <- paste(sampleinfo$age, sampleinfo$reg, sep="")
sampleinfo$qual <- "ok"
sampleinfo$qual[c(1,7,8, 25, 43, 52, 66,77)] <- "bad"
#all <- ctg3to8
#all$isg <- rownames(ctg3to8) %in% gm
mc36 <- melt(ctg3to8)
mc36$exp <- mc36$value > 1
mc36$isg <- mc36$Var1 %in% gm$marker
mc36$qual <- mc36$Var1 %in% sampleinfo$marker[sampleinfo$qual == "ok"]
ggplot(mc36, aes(y=value, x=Var1, colour=qual)) +geom_point(alpha=0.3) +facet_wrap(~Var2) +scale_y_log10()
#ggplot(mc36, aes(y=value, x=Var1, colour=exp)) +geom_point(alpha=0.3, shape=95, size=5) +facet_wrap(~Var2) +scale_y_log10() + theme(  axis.text.x = element_blank())
mc36$Var1 %in% sampleinfo$marker
mc36$Var1
sampleinfo$marker
View(mc36)
mc36$qual <- mc36$Var2 %in% sampleinfo$sample[sampleinfo$qual == "ok"]
ggplot(mc36, aes(y=value, x=Var1, colour=qual)) +geom_point(alpha=0.3) +facet_wrap(~Var2) +scale_y_log10()
ggplot(mc36, aes(y=value, x=Var1, colour=qual)) +geom_point(alpha=0.3) +facet_wrap(~Var2) +scale_y_log10() +scale_colour_manual(values=c("dark blue", "red3"))
ggplot(mc36, aes(y=value, x=Var1, colour=qual)) +geom_point(alpha=0.3) +facet_wrap(~Var2) +scale_y_log10() +scale_colour_manual(values=c("red3", "dark blue"))
#all <- ctg3to8
#all$isg <- rownames(ctg3to8) %in% gm
mc36 <- melt(ctg3to9)
mc36$exp <- mc36$value > 1
mc36$isg <- mc36$Var1 %in% gm$marker
mc36$qual <- mc36$Var2 %in% sampleinfo$sample[sampleinfo$qual == "ok"]
ggplot(mc36, aes(y=value, x=Var1, colour=qual)) +geom_point(alpha=0.3) +facet_wrap(~Var2) +scale_y_log10() +scale_colour_manual(values=c("red3", "dark blue"))
mc5 <- melt(ctg5and6.norm)
mc5h <- melt(ctg5and6hi.norm)
mc5h$hival <- mc5$value
ggplot(data=mc5h, aes(x=value, y=hival, colour=Var2)) +geom_point() +facet_wrap(~Var2, ncol=6) +scale_x_log10() +scale_y_log10()
log <- sampleinfo$sex =="F" & sampleinfo$ctg %in% c(3,4,5,7) & sampleinfo$qual == "ok" & sampleinfo$reg == ""
bcmin <- ctg3to8[,log== TRUE]
log <- sampleinfo$sex =="F" & sampleinfo$ctg %in% c(3,4,5,7) & sampleinfo$qual == "ok" & sampleinfo$reg == ""
bcmin <- ctg3to9[,log== TRUE]
bcmin.groups <- subset(sampleinfo$type, log==TRUE)
bcmin <- subset(bcmin, rownames(bcmin) %in% gm$marker)
tbc <- t(bcmin)
tbc <- tbc[,colSums(tbc) > 0]
bc.pca <- prcomp(tbc,center = TRUE,scale. = TRUE)
bc.groups <- bcmin.groups
ggbiplot(bc.pca, obs.scale = 1, var.scale = 1, ellipse = FALSE, circle = TRUE, var.axes=FALSE, labels=rownames(tbc), groups=bc.groups)+ggtitle("PCA of O vs Y: 61 chosen markers")+ scale_colour_manual(values=c("cornflower blue", "red3"))
